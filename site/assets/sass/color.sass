$accent-color: #9f9f9f
$background-color: #2c2c2c

$base-color: #e4e4e4
$focus-color: #e4e4e4
$text-color: #e4e4e4

$border-color: #e4e4e4
$tab-header-col: #4d4c4c
$active-panel-col: #16718D
$hover-panel-col: #0e5b72
$debugger-action-red: #f17559
$debugger-controls-height: 30px
$tab-height: 24px

// Main reset -------------------------------------

*
  border-color: red

body
  color: #7a7a7a
  background-color: $background-color

#page-category-name
  color: #ED5E3F

  .cm-gutters
    .syn-prod
      color: #9f9f9f

    .syn-term
      color: #008cc3

    .syn-prod-id
      color: rgb(72, 77, 85)

    .syn-class
      color: #e27923

.cst-root
  background-color: #EEE

.cst-errata
  color: red

.cst-missing
  color: #777

// Home -------------------------------------------

body
  width: 100%
  display: flex
  align-content: center
  justify-items: center
  justify-content: center
  flex-direction: column
  position: relative
  font-size: 12px

button
  font-size: 14px

#hero
  position: relative
  color: black
  width: 70vh
  height: 70vh
  margin-bottom: 15vh
  border-radius: 3px

  img
    box-sizing: content-box
    width: 90%
    margin: 0 5%

  h1
    text-align: center
    box-sizing: content-box
    font-size: 20vh
    margin: 0
    line-height: .6em
    font-weight: 400

  .feature-card
    position: relative
    width: 200px
    height: 300px
    background-color: red
    margin: 20px

// Inputs -----------------------------------------

input[type="checkbox"]
  background-color: black !important

input[type="checkbox"]:active
  background-color: unset

input[type="checkbox"]::before
  background-color: #9f9f9f !important

input[type="checkbox"]
  position: relative
  appearance: none
  display: inline-block
  background-color: #fff
  margin: auto 4px auto 6px
  font: inherit
  color: currentColor
  width: 1em
  height: 1em
  line-height: 1em
  border-radius: 2px
  transform: translateY(-0.075em)
  place-content: center
  display: flex
  align-items: center

input[type="checkbox"]:active
  background-color: unset

input[type="checkbox"]::before
  display: inline-block
  content: ""
  width: 70%
  height: 70%
  border-radius: 2px
  transform: scale(0)
  transition: 100ms transform ease-in-out
  box-shadow: inset 1em 1em var(--form-control-color)
  background-color: $debugger-action-red

input[type="checkbox"]:checked::before
  transform: scale(1)

// Scroll -----------------------------------------

.scroller
  position: relative
  display: block
  overflow: hidden
  height: 100%
  width: 100%

.scroll
  position: absolute
  width: 14px
  top: 0px
  bottom: 0px
  right: 0
  z-index: 10000
  transition: opacity 150ms

  .scroll-handle
    top: 0
    box-sizing: border-box
    position: absolute
    width: 1%
    left: 50%
    border-radius: 2px
    background: $accent-color
    transition: left 100ms, width 100ms

  &:hover .scroll-handle
    width: 100%
    left: 0

  .scroll-end, .scroll-begin
    width: 3px
    height: 3px
    border-radius: 1.5px
    left: 4px
    position: absolute

  .scroll-begin
    top: 0

  .scroll-end
    bottom: 0

  &.no-scroll
    opacity: 0

// Layout -----------------------------------------

.lab-thing-title
  position: absolute
  left: 12px
  top: -4px
  font-size: 10px
  font-weight: 800
  color: #9f9f9f

.lab-thing
  position: relative
  box-sizing: border-box
  border: 4px solid transparent
  border-top-width: 1px
  padding: 12px 8px

.lab-thing-content
  position: relative
  overflow: hidden
  width: 100%
  height: 100%
  border-radius: 2px

.thing-decoration
  background-color: $accent-color
  z-index: 1000

.lab-container
  position: relative
  width: 100%
  height: 100%
  box-sizing: border-box

  &.hori
    > .lab-thing,
    > .lab-container
      float: left
      height: 100%

  &.vert
    > .lab-thing,
    > .lab-container
      width: 100%

  button
    border-radius: 2px
    font-size: 0.9em
    padding: 2px 8px
    margin: 0 1px

// Header -----------------------------------------

.diss-line
  font-family: monospace
  margin: 0

.diss-address
  background-color: $accent-color
  padding: 2px
  width: 48px
  display: inline-block
  font-weight: 600
  text-align: right

%tabs-bottom-border
  border-bottom: 1px solid $active-panel-col

main
  position: absolute
  z-index: 100
  font-size: 12px

.hidden
  display: none

#lab
  position: fixed
  display: flex
  flex-direction: row
  top: 40px
  left: 0
  bottom: 0
  right: 0
  padding: 0
  margin: 0
  transition: opacity 100ms

  .vertical-divider-handle
    position: absolute
    top: 0
    bottom: 0
    right: 0px
    width: 2px
    cursor: col-resize
    pointer-events: all
    z-index: 100000

body.loading #lab
  opacity: 0

body.unloading #lab
  opacity: 0

#documents-host
  position: relative
  width: 0%
  overflow: hidden
  border-top: 1px solid $border-color
  transition: width 100ms

  &.loading
    transition: none

  &.active
    width: 30%
    display: block

  #documents-frame
    height: 100%
    width: 100%
    z-index: 1000000000
    transition: opacity 500ms

  &.loading #documents-frame
    opacity: 0

#shadow-backer
  position: absolute
  width: 100%
  height: $tab-height
  border-top: 1px solid $border-color

.tabs-header
  @extend %tabs-bottom-border
  top: 0
  height: $tab-height
  display: flex
  flex-direction: row
  font-weight: 500
  font-family: arial
  font-size: 1em
  line-height: 0.9em

  .tab
    width: 100px
    box-sizing: border-box
    padding: 5px 10px
    text-transform: lowercase

  .tab:hover
    cursor: pointer
    border: none

  .tab.active
    border: none

.panel-host
  position: relative
  display: grid
  flex-direction: column
  min-height: 100%
  grid-template-rows: $tab-height auto

  .panel
    box-sizing: content-box
    position: relative
    width: 100%
    height: 100%
    display: none

  .panel.active
    display: block

#syntax-input
  position: relative
  width: 100%
  height: 50%

.input-area-label
  padding: 0 10px
  width: 100%
  height: 30px
  display: flex
  align-items: center

  & button
    padding: 1px 10px
    margin-left: 20px

  & h5
    padding: 0
    margin: 0
    font-weight: 100
    line-height: 1em
    font-size: 1.2em

.button-icon
  font-size: 1.3em

#panel-bytecode
  overflow: hidden

iframe
  border: none
  overflow: hidden !important

pre
  margin: 0
  padding: 20px
  box-sizing: border-box

#left-column
  display: inline-flex
  position: relative
  flex-direction: column
  z-index: 220
  width: 50%

  .panel-host
    height: 50%
    min-height: 50%

  .tabs-header
    padding-left: 40px

// CST --------------------------------------------

.cst-node
  position: relative
  margin-left: 15px
  width: 100%
  user-select: none
  color: white

  .cst-name
    cursor: pointer

  &.nonterminal > .cst-name
    position: relative
    font-weight: bold
    border-radius: 2px
    padding: 2px 8px
    font-size: 11px
    left: -8px
    margin: 2px 0px

  .cst-rule-item-expression
    display: none
    padding-left: 10px

  &:hover >
    .cst-name .cst-rule-item-expression
      display: inline-block

  &.close > .cst-children
    display: none

  &.open
    &.nonterminal > .cst-name
      background-color: #9f9f9f

      .cst-rule-item-expression
        display: inline-block

    > .cst-children
      display: block

#ast_display
  #syntax-trees
    position: relative
    display: flex
    flex-direction: row
    font-family: 'Courier New', Courier, monospace
    height: 100%

    &> div
      position: relative
      border: 0.5px solid $border-color
      width: 100%
      overflow: auto
      padding: 5px
      box-sizing: border-box
      white-space: pre

  #syntax-output
    position: relative
    display: block
    height: 100%

#debugger-ir-state
  white-space: pre-wrap
  .source-match
    color: #ff994f

#debugger
  padding: 0px
  box-sizing: border-box
  color: $accent-color
  border-radius: 2px
  font-weight: 900
  font-size: 12px
  overflow: hidden
  position: relative
  flex-direction: column
  grid-template-columns: repeat(1, 1fr)
  grid-template-rows: $debugger-controls-height minmax(0, 1fr) minmax(0, 2fr)
  grid-column-gap: 0px
  grid-row-gap: 0px

  .lab-thing-content
    padding: 4px
    border-radius: 3px
    background-color: #0e0e0e

  .thing-decoration
    display: none

  .lab-thing-title
    display: none

  & > .debug-area
    border-bottom: 1px solid #EEE
    border-left: 1px solid #EEE

  .output
    overflow: hidden
    position: relative

  .active-rule

  .panel
    height: unset
    border-left: 1px solid $border-color

  .tabs-header
    border-color: $debugger-action-red

  #error-bar
    position: absolute
    width: 100%
    top: $debugger-controls-height
    height: 0px
    background-color: $debugger-action-red
    color: $debugger-action-red
    z-index: 1000
    box-shadow: none
    box-sizing: border-box
    padding: 0px
    font-size: 1.1em
    transition: all 200ms, color 100ms
    overflow: hidden

  #error-bar.show
    padding: 15px
    height: 50px
    color: white
    box-shadow: 0px -4px -4px #0000002b

  #error-blackout
    position: absolute
    top: $debugger-controls-height
    right: 0
    left: 0
    background-color: black
    transition: all 100ms
    pointer-events: none
    opacity: 0
    z-index: 200

  #error-blackout.show
    opacity: 0.2
    pointer-events: visible

  #panel-ast
    overflow: hidden

#debugger-output
  position: relative
  display: flex
  flex-direction: row
  font-family: 'Courier New', Courier, monospace

  &> div
    position: relative
    border: 0.5px solid $border-color
    width: 100%
    overflow: auto
    padding: 5px
    box-sizing: border-box
    white-space: pre

  #debugger-stats
    width: 320px
    flex-shrink: 0

    #debugger-disassembly
      font-size: 10px

.controls
  padding: 1px
  box-sizing: border-box
  vertical-align: middle
  user-select: none
  display: flex
  align-items: center
  text-transform: lowercase
  font-family: Arial, Helvetica, sans-serif
  text-align: center !important
  font-size: 1em
  line-height: 16px
  flex-wrap: wrap

  select
    border: none
    width: 100px
    text-align: right
    margin: 0
    background: none
    outline: none

  select:hover
    background: #EEE

  label
    position: relative
    height: 17px
    display: inline-flex
    margin: 0 4px

  input:active
    background-color: red

  .debugger-field
    background-color: #EEE
    font-size: .9em
    height: 14px
    width: 60px
    border: 1px solid #EEF
    padding: 1px
    outline: none
    margin: 0 4px
    border-radius: 3px

    &:read-only
      user-select: none
      pointer-events: none
      opacity: 0.7

  .debugger-button
    position: relative
    display: inline-block

    width: 15px
    height: 15px
    font-size: 15px

    margin: 0 5px

    color: #bab8b8

    text-align: center
    user-select: none

    &.disable
      pointer-events: none
      opacity: 0.4

    i
      vertical-align: middle
      line-height: 20px
      display: block
      position: absolute
      top: 0
      left: 0
      width: 100%
      height: 100%
      pointer-events: none
      opacity: 0.7

    i.active
      display: none
    i.hover
      display: none
    i.inactive
      display: block

    &.active
      i.inactive
        display: none
      i.hover
        display: none
      i.active
        display: block

    &:hover
      cursor: pointer

      i.inactive
        display: none
      i.active
        display: none
      i.hover
        display: block
      i
        opacity: 1.0

    &.active:hover
      i.inactive
        display: none
      i.hover
        display: none
      i.active
        display: block

    &:active
      i
        font-size: 0.9em
        opacity: 0.8

    &#restart
      color: green

    &#build
      color: $debugger-action-red
    &#build.active
      color: green

#lab-host
  flex-grow: 1
  font-size: 12px
  width: 100%
  height: 100%

#parser-metrics
  min-height: 50px

.corner-decoration
  background-clip: red
  user-select: none

body.lab header, body.docs header
  position: sticky
  top: 0
  box-sizing: border-box
  flex-direction: row
  align-items: center
  z-index: 10
  height: 40px
  display: flex
  align-items: center
  padding-right: 10px

  a
    display: contents

  #header-logo
    display: inline-block
    height: 16px
    margin-left: 10px
    margin-right: 4px

    #radlr-logo
      fill: #aeaeae !important
      transition: fill 200ms

    &:hover #radlr-logo
      fill: #f0f0f0 !important

  #page-category
    border-left: 1px solid #7777773a
    padding-left: 4px
    margin-left: 2px
    line-height: 1em
    position: relative
    font-size: 20px
    height: 20px
    text-transform: uppercase

  #page-category-name
    font-size: .75em

  .lab
    background-color: white

  a
    color: inherit

  h1
    position: relative
    display: inline-block
    line-height: 1em
    font-size: 2em
    margin: 0
    padding: 10px 5px 10px 20px
    line-height: 2em
    height: 100%

  & .buttons
    position: absolute
    right: 20px

body.lab_iframe header
  display: none

$highlight-accent-1: #ED5E3F

body
  font-size: 12px

body.docs main
  position: relative
  align-content: space-between
  justify-items: start
  font-size: 1.1em

  %nav-bar
    position: fixed
    border-top: 1px solid rgb(221, 221, 221)
    top: 40px
    width: 200px
    flex-shrink: 0
    box-sizing: content-box
    z-index: 1000000
    bottom: 0
    overflow: hidden

  // Navigation bar for the docs pages
  .docs-nav
    @extend %nav-bar
    left: 0
    display: block
    font-size: 12px
    background-color: rgb(255, 255, 255)

    & > ul > li > a
      font-size: 1.4em

    ul
      padding-left: 10px
      transition: height 200ms

    li
      padding: 4px 5px
      margin: 4px 0

    li.nav-host > a
      color: rgb(255,0 ,0 )

    li.nav-par
      //background-color: rgb(241, 241, 241)
      border-radius: 5px

  .doc-nav
    @extend %nav-bar
    width: 200px
    flex-shrink: 0
    right: 0

  content
    display: block
    position: relative
    margin: 0 auto
    margin-bottom: 200px
    top: 0
    left: 0
    padding: 0px 240px
    max-width: 920px
    flex-shrink: 1
    z-index: 0
    transition: opacity 200ms

    &> p
      color: rgb(39, 39, 39)
      padding-left: 20px
      font-size: 1.2em
      line-height: 2.0em

  p > code
      background-color: rgb(240, 240, 240)
      color: rgb(52, 97, 134)
      padding: 2px
      font-size: 0.9em
      border-radius: 2px

  h1, h2, h3, h4, h5, h6
    color: rgb(138, 138, 138)

  h3, h4, h5, h6
    margin-left: 20px

  @for $i from 1 through 6
    h#{$i}
      font-size: 1em + 0.10 * ($i - 6) * ($i - 6)

  h1
    margin-bottom: 30px
    margin-top: 0

  h2
    position: relative
    margin-top: 40px
    margin-bottom: 20px
    padding-bottom: 20px
    width: fit-content

  h2:after
    top: 10px
    left: 20px
    content: ""
    display: block
    position: relative
    height: 4px
    width: 20vw
    background-color: $highlight-accent-1

  blockquote
    font-size: 1.1em
    line-height: 2
    opacity: 0.8
    background-color: #eeeeee
    color: #232323
    border-left: 2px solid $highlight-accent-1
    margin: 0 20px/* */
    padding: 5px 15px
    border-radius: 0 0 13px 0

  .code-block
    pre
      background-color: #f1f1f1
      color: #464646
      box-sizing: content-box
      border-radius: 10px
      padding: 20px
      margin-left: 20px
      line-height: 1.3em
      overflow: auto
      font-size: 0.95em

    .lab-candidate
      position: relative
      display: block
      margin: 10px 35px 20px

      i
        font-size: 0.8em

@mixin small-docs
  main
    margin-top: 40px

    .docs-nav
      display: none

    .doc-nav
      display: none
    content
      padding: 0

      &> *
        margin: 10px 20px 10px 15px

      & > p
        padding: 0

    blockquote
      border-left: 15px solid $highlight-accent-1
      //border-right: 5px solid $highlight-accent-1
      margin: 0
      padding: 5px 10px
      line-height: 2.0em

    .code-block
      margin-top: 20px
      margin-bottom: 20px

      .lab-candidate
        margin: 10px 0 20px

      pre
        border-radius: 2px
        margin: 0
        line-height: 1.2em
        padding: 10px

    @for $i from 1 through 6
      h#{$i}
        font-size: 1em + 0.09 * ($i - 6) * ($i - 6) //

@media screen and (max-width: 1000px)
  header
    background-color: white !important

  body.docs
    @include small-docs

  body.docs main

    .docs-nav
      display: none

    .doc-nav
      display: none

body.lab-iframe
  header
    display: none !important

  docs
    @include small-docs

body.loading content, body.unloading content

  opacity: 0

// Codemirror -------------------------------

.cm-editor
  font-family: monospace
  color: #000
  direction: ltr
  left: 0
  right: 0
  top: 0
  bottom: 0
  outline: none
  position: absolute !important

  .cm-gutters
    border: none
    background-color: $accent-color
    width: 40px
    text-align: right

    .syn-prod
      color: #9f9f9f

    .syn-term
      color: #008cc3

    .syn-prod-id
      color: rgb(72, 77, 85)
      font-weight: 800

    .syn-class
      color: #e27923
      font-weight: 800

    .cm-scroller
      overflow: hidden

.cm-focused
  outline: none !important

.cst-node
  outline: none
  text-decoration: none
  font-size: 16px

.cst-root
  min-width: 20px

.cst-tk
  font-weight: bold
  margin-right: 2px

.cm-activeLine
  background-color: #626060 !important

.cm-editor
  color: #9f9f9f

.cm-content
  padding: 0 !important

.nterm-test
  background-color: yellow
  color: black

.term-test
  background-color: blue
  color: black

.parse-test
  background-color: green
  color: black

.scan-test
  border: 1px solid red
  border-left: unset

.tok-test
  background-color: orange

.skip-test
  background-color: #4f91a9

.pos-test
  border-left: 1px solid #eecd14
  position: relative
  display: inline-block

.pos-test::after
  color: #eecd14
  content: "^parser"
  position: absolute
  bottom: -9px
  left: -2px
  display: block
  font-size: 8px
  font-weight: 900
